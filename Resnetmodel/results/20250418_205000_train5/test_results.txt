D:\development\tool\Anaconda\envs\wheat-disease-wavelet-dl\python.exe D:\workspace\pyspace\code\wheat-disease-wavelet-dl\Resnetmodel\main.py 
Using default training number as no argument provided.
Epoch 1/200
----------
Train Loss: 0.6198 Acc: 0.6537
Validation Loss: 0.5003 Acc: 0.8864
D:\development\tool\Anaconda\envs\wheat-disease-wavelet-dl\lib\site-packages\torch\optim\lr_scheduler.py:232: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 2/200
----------
Train Loss: 0.5165 Acc: 0.7379
Validation Loss: 0.4280 Acc: 0.8864
Epoch 3/200
----------
Train Loss: 0.4659 Acc: 0.7913
Validation Loss: 0.3824 Acc: 0.8864
Epoch 4/200
----------
Train Loss: 0.4188 Acc: 0.8398
Validation Loss: 0.3545 Acc: 0.8864
Epoch 5/200
----------
Train Loss: 0.3465 Acc: 0.8803
Validation Loss: 0.3340 Acc: 0.8864
Epoch 6/200
----------
Train Loss: 0.3580 Acc: 0.8738
Validation Loss: 0.3209 Acc: 0.8864
Epoch 7/200
----------
Train Loss: 0.3198 Acc: 0.9013
Validation Loss: 0.3106 Acc: 0.8864
Epoch 8/200
----------
Train Loss: 0.2891 Acc: 0.9094
Validation Loss: 0.3018 Acc: 0.8864
Epoch 9/200
----------
Train Loss: 0.2836 Acc: 0.9175
Validation Loss: 0.2936 Acc: 0.8864
Epoch 10/200
----------
Train Loss: 0.2688 Acc: 0.9159
Validation Loss: 0.2869 Acc: 0.8864
Epoch 11/200
----------
Train Loss: 0.2805 Acc: 0.9207
Validation Loss: 0.2788 Acc: 0.8864
Epoch 12/200
----------
Train Loss: 0.2752 Acc: 0.9175
Validation Loss: 0.2737 Acc: 0.8864
Epoch 13/200
----------
Train Loss: 0.2442 Acc: 0.9239
Validation Loss: 0.2693 Acc: 0.8864
Epoch 14/200
----------
Train Loss: 0.2443 Acc: 0.9126
Validation Loss: 0.2649 Acc: 0.8864
Epoch 15/200
----------
Train Loss: 0.2132 Acc: 0.9223
Validation Loss: 0.2596 Acc: 0.8864
Epoch 16/200
----------
Train Loss: 0.2356 Acc: 0.9207
Validation Loss: 0.2560 Acc: 0.8864
Epoch 17/200
----------
Train Loss: 0.2085 Acc: 0.9304
Validation Loss: 0.2470 Acc: 0.8864
Epoch 18/200
----------
Train Loss: 0.2167 Acc: 0.9191
Validation Loss: 0.2481 Acc: 0.8864
EarlyStopping counter: 1 out of 20
Epoch 19/200
----------
Train Loss: 0.2118 Acc: 0.9239
Validation Loss: 0.2403 Acc: 0.8864
Epoch 20/200
----------
Train Loss: 0.2074 Acc: 0.9239
Validation Loss: 0.2382 Acc: 0.8864
Epoch 21/200
----------
Train Loss: 0.2003 Acc: 0.9223
Validation Loss: 0.2339 Acc: 0.8864
Epoch 22/200
----------
Train Loss: 0.1892 Acc: 0.9288
Validation Loss: 0.2318 Acc: 0.8864
Epoch 23/200
----------
Train Loss: 0.1986 Acc: 0.9272
Validation Loss: 0.2266 Acc: 0.8864
Epoch 24/200
----------
Train Loss: 0.1883 Acc: 0.9272
Validation Loss: 0.2223 Acc: 0.8864
Epoch 25/200
----------
Train Loss: 0.1862 Acc: 0.9272
Validation Loss: 0.2203 Acc: 0.8864
Epoch 26/200
----------
Train Loss: 0.1716 Acc: 0.9256
Validation Loss: 0.2196 Acc: 0.8864
Epoch 27/200
----------
Train Loss: 0.1824 Acc: 0.9304
Validation Loss: 0.2145 Acc: 0.8864
Epoch 28/200
----------
Train Loss: 0.1595 Acc: 0.9288
Validation Loss: 0.2109 Acc: 0.8864
Epoch 29/200
----------
Train Loss: 0.1604 Acc: 0.9239
Validation Loss: 0.2064 Acc: 0.8939
Epoch 30/200
----------
Train Loss: 0.1542 Acc: 0.9288
Validation Loss: 0.2059 Acc: 0.8939
EarlyStopping counter: 1 out of 20
Epoch 31/200
----------
Train Loss: 0.1505 Acc: 0.9353
Validation Loss: 0.2033 Acc: 0.8939
Epoch 32/200
----------
Train Loss: 0.1671 Acc: 0.9320
Validation Loss: 0.2013 Acc: 0.8939
Epoch 33/200
----------
Train Loss: 0.1543 Acc: 0.9385
Validation Loss: 0.1995 Acc: 0.8939
Epoch 34/200
----------
Train Loss: 0.1410 Acc: 0.9320
Validation Loss: 0.1981 Acc: 0.9091
Epoch 35/200
----------
Train Loss: 0.1537 Acc: 0.9385
Validation Loss: 0.1980 Acc: 0.9091
EarlyStopping counter: 1 out of 20
Epoch 36/200
----------
Train Loss: 0.1417 Acc: 0.9288
Validation Loss: 0.1957 Acc: 0.9091
Epoch 37/200
----------
Train Loss: 0.1430 Acc: 0.9272
Validation Loss: 0.1973 Acc: 0.9091
EarlyStopping counter: 1 out of 20
Epoch 38/200
----------
Train Loss: 0.1481 Acc: 0.9288
Validation Loss: 0.1911 Acc: 0.9091
Epoch 39/200
----------
Train Loss: 0.1402 Acc: 0.9353
Validation Loss: 0.1947 Acc: 0.9091
EarlyStopping counter: 1 out of 20
Epoch 40/200
----------
Train Loss: 0.1365 Acc: 0.9304
Validation Loss: 0.1946 Acc: 0.9091
EarlyStopping counter: 2 out of 20
Epoch 41/200
----------
Train Loss: 0.1341 Acc: 0.9353
Validation Loss: 0.1958 Acc: 0.9091
EarlyStopping counter: 3 out of 20
Epoch 42/200
----------
Train Loss: 0.1295 Acc: 0.9369
Validation Loss: 0.1953 Acc: 0.9091
EarlyStopping counter: 4 out of 20
Epoch 43/200
----------
Train Loss: 0.1233 Acc: 0.9515
Validation Loss: 0.1957 Acc: 0.9167
EarlyStopping counter: 5 out of 20
Epoch 44/200
----------
Train Loss: 0.1275 Acc: 0.9434
Validation Loss: 0.1936 Acc: 0.9167
EarlyStopping counter: 6 out of 20
Epoch 45/200
----------
Train Loss: 0.1254 Acc: 0.9353
Validation Loss: 0.1871 Acc: 0.9242
Epoch 46/200
----------
Train Loss: 0.1272 Acc: 0.9450
Validation Loss: 0.1853 Acc: 0.9242
Epoch 47/200
----------
Train Loss: 0.1213 Acc: 0.9434
Validation Loss: 0.1887 Acc: 0.9242
EarlyStopping counter: 1 out of 20
Epoch 48/200
----------
Train Loss: 0.1217 Acc: 0.9515
Validation Loss: 0.1880 Acc: 0.9242
EarlyStopping counter: 2 out of 20
Epoch 49/200
----------
Train Loss: 0.1234 Acc: 0.9466
Validation Loss: 0.1877 Acc: 0.9318
EarlyStopping counter: 3 out of 20
Epoch 50/200
----------
Train Loss: 0.1148 Acc: 0.9482
Validation Loss: 0.1977 Acc: 0.9242
EarlyStopping counter: 4 out of 20
Epoch 51/200
----------
Train Loss: 0.1123 Acc: 0.9482
Validation Loss: 0.1895 Acc: 0.9242
EarlyStopping counter: 5 out of 20
Epoch 52/200
----------
Train Loss: 0.1128 Acc: 0.9595
Validation Loss: 0.1846 Acc: 0.9242
Epoch 53/200
----------
Train Loss: 0.1110 Acc: 0.9531
Validation Loss: 0.1864 Acc: 0.9242
EarlyStopping counter: 1 out of 20
Epoch 54/200
----------
Train Loss: 0.1171 Acc: 0.9498
Validation Loss: 0.1885 Acc: 0.9242
EarlyStopping counter: 2 out of 20
Epoch 55/200
----------
Train Loss: 0.1207 Acc: 0.9417
Validation Loss: 0.1875 Acc: 0.9242
EarlyStopping counter: 3 out of 20
Epoch 56/200
----------
Train Loss: 0.1122 Acc: 0.9547
Validation Loss: 0.1952 Acc: 0.9242
EarlyStopping counter: 4 out of 20
Epoch 57/200
----------
Train Loss: 0.0984 Acc: 0.9531
Validation Loss: 0.1873 Acc: 0.9242
EarlyStopping counter: 5 out of 20
Epoch 58/200
----------
Train Loss: 0.0960 Acc: 0.9579
Validation Loss: 0.1894 Acc: 0.9318
EarlyStopping counter: 6 out of 20
Epoch 59/200
----------
Train Loss: 0.1038 Acc: 0.9515
Validation Loss: 0.1802 Acc: 0.9318
Epoch 60/200
----------
Train Loss: 0.1094 Acc: 0.9547
Validation Loss: 0.1842 Acc: 0.9318
EarlyStopping counter: 1 out of 20
Epoch 61/200
----------
Train Loss: 0.0972 Acc: 0.9595
Validation Loss: 0.1843 Acc: 0.9242
EarlyStopping counter: 2 out of 20
Epoch 62/200
----------
Train Loss: 0.1066 Acc: 0.9612
Validation Loss: 0.1898 Acc: 0.9242
EarlyStopping counter: 3 out of 20
Epoch 63/200
----------
Train Loss: 0.0997 Acc: 0.9547
Validation Loss: 0.1847 Acc: 0.9394
EarlyStopping counter: 4 out of 20
Epoch 64/200
----------
Train Loss: 0.0895 Acc: 0.9531
Validation Loss: 0.1852 Acc: 0.9318
EarlyStopping counter: 5 out of 20
Epoch 65/200
----------
Train Loss: 0.0987 Acc: 0.9579
Validation Loss: 0.1845 Acc: 0.9394
EarlyStopping counter: 6 out of 20
Epoch 66/200
----------
Train Loss: 0.0966 Acc: 0.9693
Validation Loss: 0.1953 Acc: 0.9242
EarlyStopping counter: 7 out of 20
Epoch 67/200
----------
Train Loss: 0.0859 Acc: 0.9628
Validation Loss: 0.1894 Acc: 0.9318
EarlyStopping counter: 8 out of 20
Epoch 68/200
----------
Train Loss: 0.0853 Acc: 0.9612
Validation Loss: 0.1891 Acc: 0.9394
EarlyStopping counter: 9 out of 20
Epoch 69/200
----------
Train Loss: 0.0937 Acc: 0.9628
Validation Loss: 0.1914 Acc: 0.9318
EarlyStopping counter: 10 out of 20
Epoch 70/200
----------
Train Loss: 0.0898 Acc: 0.9628
Validation Loss: 0.1843 Acc: 0.9545
EarlyStopping counter: 11 out of 20
Epoch 71/200
----------
Train Loss: 0.0865 Acc: 0.9595
Validation Loss: 0.1882 Acc: 0.9470
EarlyStopping counter: 12 out of 20
Epoch 72/200
----------
Train Loss: 0.0880 Acc: 0.9660
Validation Loss: 0.1920 Acc: 0.9545
EarlyStopping counter: 13 out of 20
Epoch 73/200
----------
Train Loss: 0.0862 Acc: 0.9644
Validation Loss: 0.1824 Acc: 0.9545
EarlyStopping counter: 14 out of 20
Epoch 74/200
----------
Train Loss: 0.0907 Acc: 0.9660
Validation Loss: 0.1824 Acc: 0.9545
EarlyStopping counter: 15 out of 20
Epoch 75/200
----------
Train Loss: 0.0907 Acc: 0.9547
Validation Loss: 0.1837 Acc: 0.9545
EarlyStopping counter: 16 out of 20
Epoch 76/200
----------
Train Loss: 0.0894 Acc: 0.9628
Validation Loss: 0.1931 Acc: 0.9470
EarlyStopping counter: 17 out of 20
Epoch 77/200
----------
Train Loss: 0.0925 Acc: 0.9595
Validation Loss: 0.1978 Acc: 0.9545
EarlyStopping counter: 18 out of 20
Epoch 78/200
----------
Train Loss: 0.0795 Acc: 0.9757
Validation Loss: 0.1929 Acc: 0.9545
EarlyStopping counter: 19 out of 20
Epoch 79/200
----------
Train Loss: 0.0805 Acc: 0.9757
D:\workspace\pyspace\code\wheat-disease-wavelet-dl\Resnetmodel\train_val_test.py:114: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(os.path.join(save_dir, 'best_model.pth'), map_location=device))
Validation Loss: 0.1904 Acc: 0.9545
EarlyStopping counter: 20 out of 20
Early stopping triggered
Plot saved to D:\workspace\pyspace\code\wheat-disease-wavelet-dl\Resnetmodel\results\20250418_205000_train5\training_plot_20250418_210242.png
Test Accuracy: 0.9627

Process finished with exit code 0
